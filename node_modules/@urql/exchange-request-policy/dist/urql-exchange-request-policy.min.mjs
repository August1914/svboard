import{makeOperation as e}from"@urql/core";import{tap as t,map as r}from"wonka";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function o(o){return function(c){var a=c.forward,i=new Map,u=(o||{}).ttl||3e5;function p(t){return"query"!==t.kind||"cache-first"!==t.context.requestPolicy&&"cache-only"!==t.context.requestPolicy?t:(new Date).getTime()-(i.get(t.key)||0)>u&&(!o.shouldUpgrade||o.shouldUpgrade(t))?e(t.kind,t,n({},t.context,{requestPolicy:"cache-and-network"})):t}function s(e){var t=e.operation.context.meta;(!i.has(e.operation.key)||!t||"miss"===t.cacheOutcome)&&i.set(e.operation.key,(new Date).getTime())}return function(e){return t(s)(a(r(p)(e)))}}}export{o as requestPolicyExchange};
//# sourceMappingURL=urql-exchange-request-policy.min.mjs.map
