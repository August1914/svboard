var t=require("@urql/core"),e=require("svelte/store"),n=require("svelte"),r=require("wonka");function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}new Set;var i=Object.create(null);function u(t,n,r){var o={query:t,variables:n||null,context:r},u={stale:!1,fetching:!0,data:void 0,error:void 0,extensions:void 0},a=e.writable(u),c=!1;return u.set=function(t){for(var e in t&&t!==u||(t=i),c=!0,t)"query"===e||"variables"===e||"context"===e?o[e]=t[e]:"fetching"===e?u[e]=!!t[e]:e in u&&(u[e]=t[e]);u.stale=!!t.stale,c=!1,a.set(u)},u.update=function(t){u.set(t(u))},u.subscribe=function(t,e){return a.subscribe(t,e)},Object.keys(o).forEach((function(t){Object.defineProperty(u,t,{configurable:!1,get:function(){return o[t]},set:function(e){o[t]=e,c||a.set(u)}})})),u}function a(){return n.getContext("$$_urql")}function c(t){n.setContext("$$_urql",t)}var s={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0};function f(e){return r.make((function(n){var r,o;return e.subscribe((function(e){var i=t.createRequest(e.query,e.variables),u=t.stringifyVariables(i.context=e.context);void 0!==r&&i.key===r.key&&void 0!==o&&u===o||(o=u,r=i,n.next(i))}))}))}exports.getClient=a,exports.initClient=function(e){var n=new t.Client(e);return c(n),n},exports.mutation=function(t){var e=a(),n="function"!=typeof t.subscribe?u(t.query,t.variables):t;return function(t,r){return n.set({fetching:!0,variables:t||n.variables,context:r||n.context}),e.mutation(n.query,n.variables,n.context).toPromise().then((function(t){var e=o({},{fetching:!1},t);return n.set(e),n}))}},exports.operationStore=u,exports.query=function(t){var e=a(),i=r.subscribe((function(e){t.set(e)}))(r.scan((function(t,e){return o({},t,e)}),s)(r.switchMap((function(t){return t.context&&t.context.pause?r.fromValue({fetching:!1,stale:!1}):r.concat([r.fromValue({fetching:!0,stale:!1}),r.map((function(t){return o({},{fetching:!1},t,{stale:!!t.stale})}))(e.executeQuery(t,t.context)),r.fromValue({fetching:!1,stale:!1})])}))(f(t))));return n.onDestroy(i.unsubscribe),t},exports.setClient=c,exports.subscription=function(t,e){var i=a(),u=r.subscribe((function(e){t.set(e)}))(r.scan((function(t,n){return o({},t,n,{data:void 0!==n.data?"function"==typeof e?e(t.data,n.data):n.data:t.data,stale:!1})}),s)(r.switchMap((function(e){return e.context&&e.context.pause?r.fromValue({fetching:!1}):r.concat([r.fromValue({fetching:!0}),i.executeSubscription(e,t.context),r.fromValue({fetching:!1})])}))(f(t))));return n.onDestroy(u.unsubscribe),t},Object.keys(t).forEach((function(e){"default"===e||exports.hasOwnProperty(e)||(exports[e]=t[e])}));
//# sourceMappingURL=urql-svelte.min.js.map
